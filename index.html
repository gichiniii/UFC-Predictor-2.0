<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UFC Fight Predictor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                        'primary-dark': '#4A49B8'
                    }
                }
            }
        }
    </script>
    <style>
        .fight-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .dark .fight-card {
            background: linear-gradient(135deg, #4c1d95 0%, #581c87 100%);
        }
        .prediction-card {
            transition: all 0.3s ease;
        }
        .prediction-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
    </style>
</head>
<body class="bg-white dark:bg-gray-900 min-h-screen">
    <!-- Navigation -->
    <nav class="bg-primary text-white shadow-lg">
        <div class="max-w-6xl mx-auto px-4 py-3">
            <div class="flex justify-between items-center">
                <h1 class="text-xl font-bold">ðŸ¥Š UFC Fight Predictor</h1>
                <div class="flex items-center space-x-4">
                    <span id="currentUser" class="text-sm"></span>
                    <button id="logoutBtn" class="bg-white bg-opacity-20 px-3 py-1 rounded text-sm hover:bg-opacity-30 transition-colors hidden">
                        Logout
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Login Screen -->
    <div id="loginScreen" class="max-w-md mx-auto mt-20 p-6">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8">
            <h2 class="text-2xl font-bold text-center mb-6 text-gray-900 dark:text-white">Login to UFC Predictor</h2>
            
            <!-- Admin Login -->
            <div class="mb-6">
                <h3 class="text-lg font-semibold mb-3 text-gray-800 dark:text-gray-200">Admin Access</h3>
                <input type="password" id="adminPassword" placeholder="Admin Password" 
                       class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg text-base
                              bg-white dark:bg-gray-700 text-gray-900 dark:text-white
                              focus:ring-2 focus:ring-primary focus:border-transparent">
                <button onclick="adminLogin()" 
                        class="w-full mt-2 bg-red-600 hover:bg-red-700 text-white py-3 rounded-lg font-semibold transition-colors">
                    Admin Login
                </button>
            </div>

            <div class="border-t border-gray-300 dark:border-gray-600 pt-6">
                <h3 class="text-lg font-semibold mb-3 text-gray-800 dark:text-gray-200">User Access</h3>
                <input type="text" id="username" placeholder="Enter your name" 
                       class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg text-base
                              bg-white dark:bg-gray-700 text-gray-900 dark:text-white
                              focus:ring-2 focus:ring-primary focus:border-transparent">
                <button onclick="userLogin()" 
                        class="w-full mt-2 bg-primary hover:bg-primary-dark text-white py-3 rounded-lg font-semibold transition-colors">
                    Enter as User
                </button>
            </div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="max-w-6xl mx-auto p-4 hidden">
        <div class="mb-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white">Admin Dashboard</h2>
                <button onclick="showAddFightModal()" 
                        class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-semibold transition-colors">
                    + Add Fight
                </button>
            </div>

            <!-- Tabs -->
            <div class="flex space-x-4 mb-6">
                <button onclick="showTab('fights')" id="fightsTab" 
                        class="px-4 py-2 rounded-lg font-semibold bg-primary text-white">
                    Manage Fights
                </button>
                <button onclick="showTab('predictions')" id="predictionsTab" 
                        class="px-4 py-2 rounded-lg font-semibold bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300">
                    View Predictions
                </button>
            </div>

            <!-- Fights Tab -->
            <div id="fightsTabContent">
                <div id="adminFightsList" class="space-y-4"></div>
            </div>

            <!-- Predictions Tab -->
            <div id="predictionsTabContent" class="hidden">
                <div id="predictionsList" class="space-y-4"></div>
            </div>
        </div>
    </div>

    <!-- User Panel -->
    <div id="userPanel" class="max-w-6xl mx-auto p-4 hidden">
        <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-6">Make Your Predictions</h2>
        <div id="userFightsList" class="space-y-6"></div>
    </div>

    <!-- Add Fight Modal -->
    <div id="addFightModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto">
            <h3 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">Add New Fight</h3>
            
            <div class="space-y-4">
                <input type="text" id="fighter1" placeholder="Fighter 1 Name" 
                       class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg text-base
                              bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                <input type="text" id="fighter2" placeholder="Fighter 2 Name" 
                       class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg text-base
                              bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                <input type="text" id="eventName" placeholder="Event Name (e.g., UFC 299)" 
                       class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg text-base
                              bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                <input type="date" id="fightDate" 
                       class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg text-base
                              bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                
                <div class="grid grid-cols-2 gap-4">
                    <input type="text" id="fighter1Odds" placeholder="Fighter 1 Odds (e.g., -150)" 
                           class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg text-base
                                  bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                    <input type="text" id="fighter2Odds" placeholder="Fighter 2 Odds (e.g., +130)" 
                           class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg text-base
                                  bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                </div>

                <h4 class="font-semibold text-gray-900 dark:text-white">Method of Victory Odds</h4>
                <div class="grid grid-cols-2 gap-2 text-sm">
                    <input type="text" id="koOdds" placeholder="KO/TKO Odds" 
                           class="p-2 border border-gray-300 dark:border-gray-600 rounded text-base
                                  bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                    <input type="text" id="subOdds" placeholder="Submission Odds" 
                           class="p-2 border border-gray-300 dark:border-gray-600 rounded text-base
                                  bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                    <input type="text" id="decisionOdds" placeholder="Decision Odds" 
                           class="p-2 border border-gray-300 dark:border-gray-600 rounded text-base
                                  bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                    <input type="text" id="drawOdds" placeholder="Draw Odds" 
                           class="p-2 border border-gray-300 dark:border-gray-600 rounded text-base
                                  bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                </div>
            </div>

            <div class="flex space-x-3 mt-6">
                <button onclick="saveFight()" 
                        class="flex-1 bg-primary hover:bg-primary-dark text-white py-3 rounded-lg font-semibold transition-colors">
                    Save Fight
                </button>
                <button onclick="closeAddFightModal()" 
                        class="flex-1 bg-gray-300 dark:bg-gray-600 hover:bg-gray-400 dark:hover:bg-gray-500 
                               text-gray-700 dark:text-gray-300 py-3 rounded-lg font-semibold transition-colors">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <script>
        // Initialize dark mode
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // Data Management - Using localStorage instead of sessionStorage for persistence
        const ADMIN_PASSWORD = "ufcadmin123";
        let currentUser = null;
        let isAdmin = false;

        // Load data from localStorage or initialize
        let fights = JSON.parse(localStorage.getItem('ufcFights') || '[]');
        let predictions = JSON.parse(localStorage.getItem('ufcPredictions') || '{}');

        function saveData() {
            localStorage.setItem('ufcFights', JSON.stringify(fights));
            localStorage.setItem('ufcPredictions', JSON.stringify(predictions));
        }

        // Authentication
        function adminLogin() {
            const password = document.getElementById('adminPassword').value;
            if (password === ADMIN_PASSWORD) {
                currentUser = "Admin";
                isAdmin = true;
                showPanel('admin');
            } else {
                showAlert('Incorrect admin password!');
            }
        }

        function userLogin() {
            const username = document.getElementById('username').value.trim();
            if (username) {
                currentUser = username;
                isAdmin = false;
                showPanel('user');
            } else {
                showAlert('Please enter your name!');
            }
        }

        function logout() {
            currentUser = null;
            isAdmin = false;
            showPanel('login');
        }

        function showPanel(panel) {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('adminPanel').classList.add('hidden');
            document.getElementById('userPanel').classList.add('hidden');

            if (panel === 'login') {
                document.getElementById('loginScreen').classList.remove('hidden');
                document.getElementById('currentUser').textContent = '';
                document.getElementById('logoutBtn').classList.add('hidden');
                // Clear login fields
                document.getElementById('adminPassword').value = '';
                document.getElementById('username').value = '';
            } else if (panel === 'admin') {
                document.getElementById('adminPanel').classList.remove('hidden');
                document.getElementById('currentUser').textContent = 'Admin';
                document.getElementById('logoutBtn').classList.remove('hidden');
                renderAdminFights();
                showTab('fights');
            } else if (panel === 'user') {
                document.getElementById('userPanel').classList.remove('hidden');
                document.getElementById('currentUser').textContent = currentUser;
                document.getElementById('logoutBtn').classList.remove('hidden');
                renderUserFights();
            }
        }

        // Admin Functions
        function showTab(tab) {
            if (tab === 'fights') {
                document.getElementById('fightsTab').className = 'px-4 py-2 rounded-lg font-semibold bg-primary text-white';
                document.getElementById('predictionsTab').className = 'px-4 py-2 rounded-lg font-semibold bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300';
                document.getElementById('fightsTabContent').classList.remove('hidden');
                document.getElementById('predictionsTabContent').classList.add('hidden');
                renderAdminFights();
            } else {
                document.getElementById('fightsTab').className = 'px-4 py-2 rounded-lg font-semibold bg-gray-300 dark:bg-gray-600 text-gray-700 dark:text-gray-300';
                document.getElementById('predictionsTab').className = 'px-4 py-2 rounded-lg font-semibold bg-primary text-white';
                document.getElementById('fightsTabContent').classList.add('hidden');
                document.getElementById('predictionsTabContent').classList.remove('hidden');
                renderPredictions();
            }
        }

        function showAddFightModal() {
            document.getElementById('addFightModal').classList.remove('hidden');
        }

        function closeAddFightModal() {
            document.getElementById('addFightModal').classList.add('hidden');
            // Clear form
            ['fighter1', 'fighter2', 'eventName', 'fightDate', 'fighter1Odds', 'fighter2Odds', 
             'koOdds', 'subOdds', 'decisionOdds', 'drawOdds'].forEach(id => {
                document.getElementById(id).value = '';
            });
        }

        function saveFight() {
            const newFight = {
                id: Date.now(),
                fighter1: document.getElementById('fighter1').value.trim(),
                fighter2: document.getElementById('fighter2').value.trim(),
                eventName: document.getElementById('eventName').value.trim(),
                fightDate: document.getElementById('fightDate').value,
                fighter1Odds: document.getElementById('fighter1Odds').value.trim(),
                fighter2Odds: document.getElementById('fighter2Odds').value.trim(),
                methodOdds: {
                    ko: document.getElementById('koOdds').value.trim(),
                    submission: document.getElementById('subOdds').value.trim(),
                    decision: document.getElementById('decisionOdds').value.trim(),
                    draw: document.getElementById('drawOdds').value.trim()
                }
            };

            if (!newFight.fighter1 || !newFight.fighter2) {
                showAlert('Please enter both fighter names!');
                return;
            }

            fights.push(newFight);
            saveData();
            closeAddFightModal();
            renderAdminFights();
            showAlert('Fight added successfully!');
        }

        function deleteFight(fightId) {
            showConfirmDialog('Are you sure you want to delete this fight?', () => {
                fights = fights.filter(f => f.id !== fightId);
                // Remove predictions for this fight
                Object.keys(predictions).forEach(user => {
                    if (predictions[user][fightId]) {
                        delete predictions[user][fightId];
                    }
                });
                saveData();
                renderAdminFights();
                showAlert('Fight deleted successfully!');
            });
        }

        function renderAdminFights() {
            const container = document.getElementById('adminFightsList');
            if (fights.length === 0) {
                container.innerHTML = '<p class="text-gray-600 dark:text-gray-400 text-center py-8">No fights added yet. Click "Add Fight" to get started!</p>';
                return;
            }

            let htmlContent = '';
            for (let i = 0; i < fights.length; i++) {
                const currentFight = fights[i];
                htmlContent += `
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="text-lg font-bold text-gray-900 dark:text-white">${currentFight.fighter1} vs ${currentFight.fighter2}</h3>
                                <p class="text-gray-600 dark:text-gray-400">${currentFight.eventName} â€¢ ${new Date(currentFight.fightDate).toLocaleDateString()}</p>
                            </div>
                            <button onclick="deleteFight(${currentFight.id})" 
                                    class="text-red-600 hover:text-red-800 font-semibold">
                                Delete
                            </button>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <div class="text-center">
                                <p class="font-semibold text-gray-900 dark:text-white">${currentFight.fighter1}</p>
                                <p class="text-primary font-bold">${currentFight.fighter1Odds || 'No odds'}</p>
                            </div>
                            <div class="text-center">
                                <p class="font-semibold text-gray-900 dark:text-white">${currentFight.fighter2}</p>
                                <p class="text-primary font-bold">${currentFight.fighter2Odds || 'No odds'}</p>
                            </div>
                        </div>

                        ${Object.values(currentFight.methodOdds).some(odd => odd) ? `
                            <div class="border-t border-gray-200 dark:border-gray-600 pt-4">
                                <p class="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">Method of Victory Odds:</p>
                                <div class="grid grid-cols-2 gap-2 text-sm">
                                    ${currentFight.methodOdds.ko ? <span class="text-gray-600 dark:text-gray-400">KO/TKO: ${currentFight.methodOdds.ko}</span> : ''}
                                    ${currentFight.methodOdds.submission ? <span class="text-gray-600 dark:text-gray-400">Submission: ${currentFight.methodOdds.submission}</span> : ''}
                                    ${currentFight.methodOdds.decision ? <span class="text-gray-600 dark:text-gray-400">Decision: ${currentFight.methodOdds.decision}</span> : ''}
                                    ${currentFight.methodOdds.draw ? <span class="text-gray-600 dark:text-gray-400">Draw: ${currentFight.methodOdds.draw}</span> : ''}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                `;
            }
            container.innerHTML = htmlContent;
        }

        function renderPredictions() {
            const container = document.getElementById('predictionsList');
            
            if (Object.keys(predictions).length === 0) {
                container.innerHTML = '<p class="text-gray-600 dark:text-gray-400 text-center py-8">No predictions made yet!</p>';
                return;
            }

            const predictionsByFight = {};
            
            // Group predictions by fight
            Object.keys(predictions).forEach(user => {
                Object.keys(predictions[user]).forEach(fightId => {
                    if (!predictionsByFight[fightId]) {
                        predictionsByFight[fightId] = [];
                    }
                    predictionsByFight[fightId].push({
                        user,
                        prediction: predictions[user][fightId]
                    });
                });
            });

            container.innerHTML = Object.keys(predictionsByFight).map(fightId => {
                const fight = fights.find(f => f.id == fightId);
                if (!fight) return '';

                return `
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md p-6">
                        <h3 class="text-lg font-bold text-gray-900 dark:text-white mb-4">${fight.fighter1} vs ${fight.fighter2}</h3>
                        <div class="space-y-3">
                            ${predictionsByFight[fightId].map(({ user, prediction }) => `
                                <div class="flex justify-between items-center p-3 bg-gray-50 dark:bg-gray-700 rounded">
                                    <span class="font-semibold text-gray-900 dark:text-white">${user}</span>
                                    <span class="text-primary font-semibold">${prediction.winner} by ${prediction.method}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // User Functions
        function renderUserFights() {
            const container = document.getElementById('userFightsList');
            
            if (fights.length === 0) {
                container.innerHTML = '<p class="text-gray-600 dark:text-gray-400 text-center py-8">No fights available for prediction yet!</p>';
                return;
            }

            container.innerHTML = fights.map(fight => {
                const userPrediction = predictions[currentUser] && predictions[currentUser][fight.id];
                
                return `
                    <div class="fight-card rounded-lg p-6 text-white prediction-card">
                        <div class="text-center mb-6">
                            <h3 class="text-2xl font-bold mb-2">${fight.fighter1} vs ${fight.fighter2}</h3>
                            <p class="opacity-90">${fight.eventName} â€¢ ${new Date(fight.fightDate).toLocaleDateString()}</p>
                        </div>

                        ${userPrediction ? `
                            <div class="bg-white bg-opacity-20 rounded-lg p-4 text-center">
                                <p class="text-lg font-semibold">Your Prediction:</p>
                                <p class="text-xl font-bold">${userPrediction.winner} by ${userPrediction.method}</p>
                            </div>
                        ` : `
                            <div class="grid grid-cols-2 gap-4 mb-6">
                                <div class="text-center">
                                    <p class="text-lg font-semibold">${fight.fighter1}</p>
                                    <p class="text-2xl font-bold">${fight.fighter1Odds || 'N/A'}</p>
                                </div>
                                <div class="text-center">
                                    <p class="text-lg font-semibold">${fight.fighter2}</p>
                                    <p class="text-2xl font-bold">${fight.fighter2Odds || 'N/A'}</p>
                                </div>
                            </div>

                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-semibold mb-2">Pick Winner:</label>
                                    <div class="grid grid-cols-2 gap-2">
                                        <button onclick="selectWinner(${fight.id}, '${fight.fighter1}')" 
                                                id="winner_${fight.id}${fight.fighter1.replace(/\s+/g, '')}"
                                                class="p-3 bg-white bg-opacity-20 rounded-lg hover:bg-opacity-30 transition-colors winner-btn">
                                            ${fight.fighter1}
                                        </button>
                                        <button onclick="selectWinner(${fight.id}, '${fight.fighter2}')" 
                                                id="winner_${fight.id}${fight.fighter2.replace(/\s+/g, '')}"
                                                class="p-3 bg-white bg-opacity-20 rounded-lg hover:bg-opacity-30 transition-colors winner-btn">
                                            ${fight.fighter2}
                                        </button>
                                    </div>
                                </div>

                                <div>
                                    <label class="block text-sm font-semibold mb-2">Method of Victory:</label>
                                    <div class="grid grid-cols-2 gap-2">
                                        <button onclick="selectMethod(${fight.id}, 'KO/TKO')" 
                                                id="method_${fight.id}_KO"
                                                class="p-2 bg-white bg-opacity-20 rounded hover:bg-opacity-30 transition-colors method-btn">
                                            KO/TKO ${fight.methodOdds.ko ? (${fight.methodOdds.ko}) : ''}
                                        </button>
                                        <button onclick="selectMethod(${fight.id}, 'Submission')" 
                                                id="method_${fight.id}_Submission"
                                                class="p-2 bg-white bg-opacity-20 rounded hover:bg-opacity-30 transition-colors method-btn">
                                            Submission ${fight.methodOdds.submission ? (${fight.methodOdds.submission}) : ''}
                                        </button>
                                        <button onclick="selectMethod(${fight.id}, 'Decision')" 
                                                id="method_${fight.id}_Decision"
                                                class="p-2 bg-white bg-opacity-20 rounded hover:bg-opacity-30 transition-colors method-btn">
                                            Decision ${fight.methodOdds.decision ? (${fight.methodOdds.decision}) : ''}
                                        </button>
                                        <button onclick="selectMethod(${fight.id}, 'Draw')" 
                                                id="method_${fight.id}_Draw"
                                                class="p-2 bg-white bg-opacity-20 rounded hover:bg-opacity-30 transition-colors method-btn">
                                            Draw ${fight.methodOdds.draw ? (${fight.methodOdds.draw}) : ''}
                                        </button>
                                    </div>
                                </div>

                                <button onclick="submitPrediction(${fight.id})" 
                                        id="submit_${fight.id}"
                                        class="w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-bold transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                                        disabled>
                                    Submit Prediction
                                </button>
                            </div>
                        `}
                    </div>
                `;
            }).join('');
        }

        let selectedWinners = {};
        let selectedMethods = {};

        function selectWinner(fightId, winner) {
            selectedWinners[fightId] = winner;
            
            // Update button styles
            const buttons = document.querySelectorAll([id^="winner_${fightId}_"]);
            buttons.forEach(btn => {
                btn.className = 'p-3 bg-white bg-opacity-20 rounded-lg hover:bg-opacity-30 transition-colors winner-btn';
            });
            
            const selectedBtn = document.getElementById(winner_${fightId}_${winner.replace(/\s+/g, '_')});
            if (selectedBtn) {
                selectedBtn.className = 'p-3 bg-green-500 bg-opacity-80 rounded-lg winner-btn';
            }
            
            updateSubmitButton(fightId);
        }

        function selectMethod(fightId, method) {
            selectedMethods[fightId] = method;
            
            // Update button styles
            const buttons = document.querySelectorAll([id^="method_${fightId}_"]);
            buttons.forEach(btn => {
                btn.className = 'p-2 bg-white bg-opacity-20 rounded hover:bg-opacity-30 transition-colors method-btn';
            });
            
            const selectedBtn = document.getElementById(method_${fightId}_${method.replace(/[^a-zA-Z]/g, '')});
            if (selectedBtn) {
                selectedBtn.className = 'p-2 bg-green-500 bg-opacity-80 rounded method-btn';
            }
            
            updateSubmitButton(fightId);
        }

        function updateSubmitButton(fightId) {
            const submitBtn = document.getElementById(submit_${fightId});
            if (selectedWinners[fightId] && selectedMethods[fightId]) {
                submitBtn.disabled = false;
                submitBtn.className = 'w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-bold transition-colors';
            }
        }

        function submitPrediction(fightId) {
            if (!selectedWinners[fightId] || !selectedMethods[fightId]) {
                showAlert('Please select both a winner and method of victory!');
                return;
            }

            if (!predictions[currentUser]) {
                predictions[currentUser] = {};
            }

            predictions[currentUser][fightId] = {
                winner: selectedWinners[fightId],
                method: selectedMethods[fightId]
            };

            saveData();
            renderUserFights();
            showAlert('Prediction submitted successfully!');
        }

        // Utility Functions
        function showAlert(message) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <p class="text-gray-700 dark:text-gray-300 mb-4">${message}</p>
                    <button class="w-full px-4 py-2 bg-primary text-white hover:bg-primary-dark rounded" onclick="this.closest('.fixed').remove()">OK</button>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function showConfirmDialog(message, onConfirm) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <p class="text-gray-700 dark:text-gray-300 mb-4">${message}</p>
                    <div class="flex justify-end space-x-3">
                        <button class="cancel-btn px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded">Cancel</button>
                        <button class="confirm-btn px-4 py-2 bg-red-500 text-white hover:bg-red-600 rounded">Confirm</button>
                    </div>
                </div>
            `;
            
            // Add event listeners
            const cancelBtn = modal.querySelector('.cancel-btn');
            const confirmBtn = modal.querySelector('.confirm-btn');
            
            cancelBtn.addEventListener('click', () => {
                document.body.removeChild(modal);
            });
            
            confirmBtn.addEventListener('click', () => {
                document.body.removeChild(modal);
                onConfirm();
            });
            
            document.body.appendChild(modal);
        }

        // Event Listeners
        document.getElementById('logoutBtn').addEventListener('click', logout);

        // Enter key support for login
        document.getElementById('adminPassword').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') adminLogin();
        });

        document.getElementById('username').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') userLogin();
        });

        // Initialize app
        showPanel('login');
    </script>
</body>
</html>